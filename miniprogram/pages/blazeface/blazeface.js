"use strict";var index=require("../../chunks/index.js");var tfjs=require("../../chunks/tfjs.js");Page({helper:null,async onReady(){console.log("blazeface onReady");await tfjs.ready();console.log("tf ready");const helper=this.selectComponent("#helper");console.log("blazeface load start");const model=await index.load();console.log("blazeface load end");const onFrame=(frame,deps)=>{const{ctx:ctx}=deps;const video={width:frame.width,height:frame.height,data:new Uint8Array(frame.data)};const returnTensors=false;const flipHorizontal=false;const annotateBoxes=true;const t=Date.now();const predictions=model.estimateFaces(video,returnTensors,flipHorizontal,annotateBoxes);console.log("predict cost",Date.now()-t);helper.drawCanvas2D(frame);if(predictions.length>0){for(let i=0;i<predictions.length;i++){const start=predictions[i].topLeft;const end=predictions[i].bottomRight;const size=[end[0]-start[0],end[1]-start[1]];ctx.fillStyle="rgba(255, 0, 0, 0.5)";ctx.fillRect(start[0],start[1],size[0],size[1]);{const landmarks=predictions[i].landmarks;ctx.fillStyle="blue";for(let j=0;j<landmarks.length;j++){const x=landmarks[j][0];const y=landmarks[j][1];ctx.fillRect(x,y,5,5)}}}}};helper.set({onFrame:onFrame});this.helper=helper},onShow:function(){var _a;(_a=this.helper)==null?void 0:_a.start()},onHide:function(){var _a;(_a=this.helper)==null?void 0:_a.stop()},onUnload:function(){},onShareAppMessage:function(){}});
